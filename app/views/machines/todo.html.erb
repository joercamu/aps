<div ng-app="apsApp">
	<div ng-controller="machinesController">
		<p class="subtitle">
			<strong style="color:#008CBA"><%=@machine.name%></strong>
			<%@machine.procedures.first.machines.each do |machine|%>
				<%= link_to machine.name, todo_subprocess_path(machine), target:"_self",class:"label"%>
			<%end%>
		</p>
		<p id="dateTimeNow"></p>
		<input id="id_machine" value="<%=@machine.id%>" type="hidden">
		<table>
			<tr>
				<th>ID</th>
				<th>PEDIDO</th>
				<th>TIPO</th>
				<th>CLIENTE</th>
				<th>FICHA</th>
				<th>METROS</th>
				<th>CANTIDAD</th>
				<th>MINUTES</th>
				<th>PELICULA</th>
				<th>RODILLO</th>
				<th>CABIDAS</th>
				<th>FECHA I</th>
				<th>FECHA F</th>
				<th>PARCIAL</th>
				<th>TERMINAR</th>
			</tr>
			<tr ng-repeat="subprocess in subprocesses">
				<td>{{ subprocess.id }}</td>
				<td>K{{ subprocess.order.order_number }} {{validate_quantiry_missing(subprocess.order.repeat)}}</td>
				<td>{{ subprocess.order.order_type }}</td>
				<td>{{ subprocess.order.outsourced_name }}</td>
				<td>{{ subprocess.order.sheet_client }}-{{ subprocess.order.sheet_number }}</td>

				<td>{{ subprocess.meter }}</td>
				<td>{{ subprocess.order.order_quantity}} {{subprocess.order.order_um}}</td>
				<td>{{ subprocess.minutes }}"</td>

				<td>{{ subprocess.order.sheet_film }}-{{subprocess.order.sheet_caliber}}</td>
				<td>{{ subprocess.order.sheet_roller }}</td>
				<td>{{ subprocess.order.sheet_spaces }} Cab</td>

				

				<td>{{ subprocess.start_date | date :'short'}}</td>
				<td>{{ subprocess.end_date | date :'short'}}</td>
				
				<td>
					<div class="row collapse postfix-round" ng-init="subprocess.sw = true">
				        <div class="small-9 columns">
				          <input style="width:100px" ng-model="subprocess.quantity_finished" ng-readonly="subprocess.sw" ng-click="subprocess.sw = false" type="number">
				        </div>
				        <div class="small-3 columns">
				          <button ng-click="saveQuantityFinished(subprocess)" class="button postfix"><i class="icon-floppy-o"></i></button>
				        </div>
				    </div>
			  </td>
       
				<td><button ng-click="endSubprocess(subprocess.id)" class="button success tiny">TERMINAR</button></td>
				
			</tr>
		</table>
	</div>
</div>
<script type="text/javascript">
	$(document).ready(function(){
		$('#contentMain').addClass('full-width');
		moment.locale('es');
		$('#dateTimeNow').text(moment().format('LL'));
		
	});
</script>